"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("react");function t(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var n=t(e);const l=n.default.createContext(null);let r=null;const c=({value:t,children:c})=>{const[o,u]=n.default.useState(null),[a,s]=n.default.useState(!1),f=require("./lib-rserve");n.default.useEffect((()=>{if(t.host&&(!o||!o.running))try{let e;const n={...t,on_connect:()=>{s(!1),console.log("connected"),u(e)},on_close:()=>{u(null),console.log("disconnected, retrying connection ..."),s(!0),e=f.create({...n})}};s(!0),e=f.create({...n})}catch(e){u(null),console.log(e)}}),[t,o]);return e.useEffect((()=>(null!==r&&clearInterval(r),r=setInterval((()=>{o&&o.running&&o.ocap(((e,t)=>t.heartbeat?t.heartbeat(((e,t)=>0)):0))}),[2e4]),()=>clearInterval(r))),[o]),n.default.createElement(l.Provider,{value:{R:o,connecting:a}},c)};exports.Rserve=({host:e,children:t})=>n.default.createElement(c,{value:{host:e}},t),exports.useRserve=function(){return n.default.useContext(l)};
